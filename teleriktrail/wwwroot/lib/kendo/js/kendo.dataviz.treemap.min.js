/**
 * Kendo UI v2025.3.1002 (http://www.telerik.com/kendo-ui)
 * Copyright 2025 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("kendo.data.js"),require("kendo.userevents.js"),require("kendo.dataviz.themes.js")):"function"==typeof define&&define.amd?define(["exports","kendo.data.min","kendo.userevents.min","kendo.dataviz.themes.min"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).kendo=t.kendo||{},t.kendo._globals=t.kendo._globals||{},t.kendo._globals.DatavizTreemap={}))}(this,(function(t){!function(t){var e=Math,i=Array.isArray,r=window.kendo,a=r._outerHeight,n=r._outerWidth,o=r.Class,h=r.ui.Widget,s=r.template,l=r.deepExtend,d=r.data.HierarchicalDataSource,u=r.getter,c=r.dataviz;var v=".kendoTreeMap",f="change",p="dataBound",g="itemCreated",m=Number.MAX_VALUE,_="mouseover"+v,w="mouseleave"+v;var y=h.extend({init:function(e,i){r.destroy(e),t(e).empty(),h.fn.init.call(this,e,i),this.wrapper=this.element,this._initTheme(this.options),this.element.addClass("k-widget k-treemap"),this._setLayout(),this._originalOptions=l({},this.options),this._initDataSource(),this._attachEvents(),r.notify(this,c.ui)},options:{name:"TreeMap",theme:"sass",autoBind:!0,textField:"text",valueField:"value",colorField:"color"},events:[p,g],_initTheme:function(t){var e=((c.ui.themes||{})[((t||{}).theme||"").toLowerCase()]||{}).treeMap;this.options=l({},e,t)},_attachEvents:function(){this.element.on(_,this._mouseover.bind(this)).on(w,this._mouseleave.bind(this)),this._resizeHandler=this.resize.bind(this,!1),r.onResize(this._resizeHandler)},_setLayout:function(){"horizontal"===this.options.type?(this._layout=new b(!1),this._view=new z(this,this.options)):"vertical"===this.options.type?(this._layout=new b(!0),this._view=new z(this,this.options)):(this._layout=new k,this._view=new x(this,this.options))},_initDataSource:function(){var t=this,e=t.options.dataSource;t._dataChangeHandler=t._onDataChange.bind(t),t.dataSource=d.create(e).bind(f,t._dataChangeHandler),e&&t.options.autoBind&&t.dataSource.fetch()},setDataSource:function(t){var e=this;e.dataSource.unbind(f,e._dataChangeHandler),e.dataSource=t.bind(f,e._dataChangeHandler),t&&e.options.autoBind&&e.dataSource.fetch()},_onDataChange:function(t){var e=t.node;var i=t.items;var o=this.options;var h,s;if(e){if(i.length){var l=this._getByUid(e.uid);for(l.children=[],i=new r.data.Query(i)._sortForGrouping(o.valueField,"desc"),s=0;s<i.length;s++)h=i[s],l.children.push(this._wrapItem(h));var d=this._view.htmlSize(l);this._layout.compute(l.children,l.coord,d),this._setColors(l.children),this._view.render(l)}}else this.element.empty(),h=this._wrapItem(i[0]),this._layout.createRoot(h,n(this.element),a(this.element),"vertical"===this.options.type),this._view.createRoot(h),this._root=h,this._colorIdx=0;for(s=0;s<i.length;s++)i[s].load();e&&this.trigger(p,{node:e})},_setColors:function(t){var e=this.options.colors;var r=e[this._colorIdx%e.length];var a,n;i(r)&&(a=function(t,e,i){var r=H(t);var a=H(e);var n=D(t)-D(e)<0;var o=[];o.push(t);for(var h=0;h<i;h++){var s={r:I(r.r,a.r,h,i,n),g:I(r.g,a.g,h,i,n),b:I(r.b,a.b,h,i,n)};o.push(T(s))}return o.push(e),o}(r[0],r[1],t.length));var o=!1;for(var h=0;h<t.length;h++)S((n=t[h]).color)||(n.color=a?a[h]:r),n.dataItem.hasChildren||(o=!0);o&&this._colorIdx++},_contentSize:function(t){this.view.renderHeight(t)},_wrapItem:function(t){var e={};return S(this.options.valueField)&&(e.value=C(this.options.valueField,t)),S(this.options.colorField)&&(e.color=C(this.options.colorField,t)),S(this.options.textField)&&(e.text=C(this.options.textField,t)),e.level=t.level(),e.dataItem=t,e},_getByUid:function(t){var e=[this._root];var i;for(;e.length;){if((i=e.pop()).dataItem.uid===t)return i;i.children&&(e=e.concat(i.children))}},dataItem:function(e){var i=t(e).attr(r.attr("uid")),a=this.dataSource;return a&&a.getByUid(i)},findByUid:function(t){return this.element.find(".k-treemap-tile["+r.attr("uid")+"='"+t+"']")},_mouseover:function(e){var i=t(e.target);i.hasClass("k-leaf")&&(this._removeActiveState(),i.removeClass("k-hover").addClass("k-hover"))},_removeActiveState:function(){this.element.find(".k-hover").removeClass("k-hover")},_mouseleave:function(){this._removeActiveState()},destroy:function(){h.fn.destroy.call(this),this.element.off(v),this.dataSource&&this.dataSource.unbind(f,this._dataChangeHandler),this._root=null,r.unbindResize(this._resizeHandler),r.destroy(this.element)},items:function(){return t()},getSize:function(){return r.dimensions(this.element)},_resize:function(){var t=this._root;if(t){var e=this.element;var i=e.children();t.coord.width=n(e),t.coord.height=a(e),i.css({width:t.coord.width,height:t.coord.height}),this._resizeItems(t,i)}},_resizeItems:function(t,e){if(t.children&&t.children.length){var i=e.children(".k-treemap-wrap").children();var a,n;this._layout.compute(t.children,t.coord,{text:this._view.titleSize(t,e)});for(var o=0;o<t.children.length;o++)a=t.children[o],n=i.filter("["+r.attr("uid")+"='"+a.dataItem.uid+"']"),this._view.setItemSize(a,n),this._resizeItems(a,n)}},setOptions:function(t){var e=t.dataSource;t.dataSource=undefined,this._originalOptions=l(this._originalOptions,t),this.options=l({},this._originalOptions),this._setLayout(),this._initTheme(this.options),h.fn._setEvents.call(this,t),e&&this.setDataSource(d.create(e)),this.options.autoBind&&this.dataSource.fetch()}});var k=o.extend({createRoot:function(t,e,i){t.coord={width:e,height:i,top:0,left:0}},leaf:function(t){return!t.children},layoutChildren:function(t,e){var i=e.width*e.height;var r,a=0,n=[];for(r=0;r<t.length;r++)n[r]=parseFloat(t[r].value),a+=n[r];for(r=0;r<n.length;r++)t[r].area=i*n[r]/a;var o=this.layoutHorizontal()?e.height:e.width;var h=[t[0]];var s=t.slice(1);this.squarify(s,h,o,e)},squarify:function(t,e,i,r){this.computeDim(t,e,i,r)},computeDim:function(t,e,i,r){if(t.length+e.length!=1)if(t.length>=2&&0===e.length&&(e=[t[0]],t=t.slice(1)),0!==t.length){var a=t[0];if(this.worstAspectRatio(e,i)>=this.worstAspectRatio([a].concat(e),i))this.computeDim(t.slice(1),e.concat([a]),i,r);else{var n=this.layoutRow(e,i,r);this.computeDim(t,[],n.dim,n)}}else e.length>0&&this.layoutRow(e,i,r);else{var o=1==t.length?t:e;this.layoutLast(o,i,r)}},layoutLast:function(t,e,i){t[0].coord=i},layoutRow:function(t,e,i){return this.layoutHorizontal()?this.layoutV(t,e,i):this.layoutH(t,e,i)},orientation:"h",layoutVertical:function(){return"v"===this.orientation},layoutHorizontal:function(){return"h"===this.orientation},layoutChange:function(){this.orientation=this.layoutVertical()?"h":"v"},worstAspectRatio:function(t,i){if(!t||0===t.length)return m;var r=0,a=0,n=m;for(var o=0;o<t.length;o++){var h=t[o].area;r+=h,n=n<h?n:h,a=a>h?a:h}return e.max(i*i*a/(r*r),r*r/(i*i*n))},compute:function(t,e,i){if(e.width>=e.height&&this.layoutHorizontal()||this.layoutChange(),t&&t.length>0){var r={width:e.width,height:e.height-i.text,top:0,left:0};this.layoutChildren(t,r)}},layoutV:function(t,i,r){var a=0;i=F(this._totalArea(t)/i);for(var n=0;n<t.length;n++){var o=F(t[n].area/i);t[n].coord={height:o,width:i,top:r.top+a,left:r.left},a+=o}var h={height:r.height,width:r.width-i,top:r.top,left:r.left+i};return h.dim=e.min(h.width,h.height),h.dim!=h.height&&this.layoutChange(),h},layoutH:function(t,i,r){var a=F(this._totalArea(t)/i),n=r.top,o=0;for(var h=0;h<t.length;h++)t[h].coord={height:a,width:F(t[h].area/a),top:n,left:r.left+o},o+=t[h].coord.width;var s={height:r.height-a,width:r.width,top:r.top+a,left:r.left};return s.dim=e.min(s.width,s.height),s.dim!=s.width&&this.layoutChange(),s},_totalArea:function(t){var e=0;for(var i=0;i<t.length;i++)e+=t[i].area;return e}});var x=o.extend({init:function(e,i){this.options=l({},this.options,i),this.treeMap=e,this.element=t(e.element),this.offset=0},titleSize:function(t,e){return e.children(".k-treemap-title").height()||0},htmlSize:function(t){var e=this._getByUid(t.dataItem.uid);var i={text:0};if(t.children){if(this._clean(e),this._getText(t)){var r=this._createTitle(t);e.append(r),this._compile(r,t.dataItem),i.text=r.height()}e.append(this._createWrap()),this.offset=(n(e)-e.innerWidth())/2}return i},_compile:function(t,e){},_getByUid:function(t){return this.element.find(".k-treemap-tile["+r.attr("uid")+"='"+t+"']")},render:function(t){var e=this._getByUid(t.dataItem.uid);var i=t.children;if(i){var r=e.find(".k-treemap-wrap");for(var a=0;a<i.length;a++){var n=i[a];var o=this._createLeaf(n);r.append(o),this._compile(o.children(),n.dataItem),this.treeMap.trigger(g,{element:o})}}},createRoot:function(t){var e=this._createLeaf(t);this.element.append(e),this._compile(e.children(),t.dataItem),this.treeMap.trigger(g,{element:e})},_clean:function(t){t.css("background-color",""),t.removeClass("k-leaf"),t.removeClass("k-inverse"),t.empty()},_createLeaf:function(e){return this._createTile(e).css("background-color",e.color).addClass("k-leaf").toggleClass("k-inverse",this._tileColorBrightness(e)>180).toggle(0!==e.value).append(t("<div></div>").html(this._getText(e)))},_createTile:function(e){var i=t("<div class='k-treemap-tile'></div>");return this.setItemSize(e,i),S(e.dataItem)&&S(e.dataItem.uid)&&i.attr(r.attr("uid"),e.dataItem.uid),i},_itemCoordinates:function(t){var e={width:t.coord.width,height:t.coord.height,left:t.coord.left,top:t.coord.top};return e.left&&this.offset?e.width+=2*this.offset:e.width+=this.offset,e.top?e.height+=2*this.offset:e.height+=this.offset,e},setItemSize:function(t,e){var i=this._itemCoordinates(t);e.css({width:i.width,height:i.height,left:i.left,top:i.top})},_getText:function(t){return this.options.template?this._renderTemplate(t):r.htmlEncode(t.text)},_renderTemplate:function(t){return s(this.options.template)({dataItem:t.dataItem,text:t.text})},_createTitle:function(e){return t("<div class='k-treemap-title'></div>").append(t("<div></div>").html(this._getText(e)))},_createWrap:function(){return t("<div class='k-treemap-wrap'></div>")},_tileColorBrightness:function(t){return D(t.color)}});var b=o.extend({createRoot:function(t,e,i,r){t.coord={width:e,height:i,top:0,left:0},t.vertical=r},init:function(t){this.vertical=t,this.quotient=t?1:0},compute:function(t,e,i){if(t.length>0){var r=e.width;var a=e.height;this.vertical?a-=i.text:r-=i.text;var n={width:r,height:a,top:0,left:0};this.layoutChildren(t,n)}},layoutChildren:function(t,e){var i=e.width*e.height;var r=0;var a=[];var n;for(n=0;n<t.length;n++){var o=t[n];a[n]=parseFloat(t[n].value),r+=a[n],o.vertical=this.vertical}for(n=0;n<a.length;n++)t[n].area=i*a[n]/r;this.sliceAndDice(t,e)},sliceAndDice:function(t,e){var i=this._totalArea(t);t[0].level%2===this.quotient?this.layoutHorizontal(t,e,i):this.layoutVertical(t,e,i)},layoutHorizontal:function(t,e,i){var r=0;for(var a=0;a<t.length;a++){var n=t[a];var o=n.area/(i/e.width);n.coord={height:e.height,width:o,top:e.top,left:e.left+r},r+=o}},layoutVertical:function(t,e,i){var r=0;for(var a=0;a<t.length;a++){var n=t[a];var o=n.area/(i/e.height);n.coord={height:o,width:e.width,top:e.top+r,left:e.left},r+=o}},_totalArea:function(t){var e=0;for(var i=0;i<t.length;i++)e+=t[i].area;return e}});var z=x.extend({htmlSize:function(t){var e=this._getByUid(t.dataItem.uid);var i={text:0,offset:0};if(t.children){if(this._clean(e),this._getText(t)){var r=this._createTitle(t);e.append(r),this._compile(r,t.dataItem),t.vertical?i.text=r.height():i.text=r.width()}e.append(this._createWrap()),this.offset=(n(e)-e.innerWidth())/2}return i},titleSize:function(t,e){return(t.vertical?e.children(".k-treemap-title").height():e.children(".k-treemap-title-vertical").width())||0},_createTitle:function(e){return(e.vertical?t("<div class='k-treemap-title'></div>"):t("<div class='k-treemap-title-vertical'></div>")).append(t("<div></div>").html(this._getText(e)))}});function C(t,e){return null===e?e:u(t,!0)(e)}function S(t){return void 0!==t}function I(t,i,r,a,n){var o=e.min(e.abs(t),e.abs(i));var h=e.max(e.abs(t),e.abs(i));var s=(h-o)/(a+1)*(r+1);return n?o+s:h-s}function T(t){return"#"+A(t.r)+A(t.g)+A(t.b)}function H(t){var e=function(t){var e=t.length;var i={};3===e?(i.r=t[0],i.g=t[1],i.b=t[2]):(i.r=t.substring(0,2),i.g=t.substring(2,4),i.b=t.substring(4,6));return i}(t=t.replace("#",""));return{r:B(e.r),g:B(e.g),b:B(e.b)}}function A(t){var i=e.round(t).toString(16).toUpperCase();return 1===i.length&&(i="0"+i),i}function B(t){return parseInt(t.toString(16),16)}function D(t){var i=0;return t&&(t=H(t),i=e.sqrt(.241*t.r*t.r+.691*t.g*t.g+.068*t.b*t.b)),i}function F(t){var i=e.pow(10,4);return e.round(t*i)/i}c.ui.plugin(y)}(window.kendo.jQuery);var e=kendo;t.__meta__={id:"dataviz.treeMap",name:"TreeMap",category:"dataviz",description:"The Kendo DataViz TreeMap",depends:["data","userevents","dataviz.themes"]},t.default=e,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=kendo.dataviz.treemap.min.js.map
