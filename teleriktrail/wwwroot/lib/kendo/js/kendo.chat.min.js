/**
 * Kendo UI v2025.3.1002 (http://www.telerik.com/kendo-ui)
 * Copyright 2025 Progress Software Corporation and/or one of its subsidiaries or affiliates. All rights reserved.
 *
 * Kendo UI commercial licenses may be obtained at
 * http://www.telerik.com/purchase/license-agreement/kendo-ui-complete
 * If you do not own a commercial license, this file shall be governed by the trial license terms.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("kendo.textbox.js"),require("kendo.licensing.js"),require("kendo.avatar.js"),require("kendo.icons.js"),require("kendo.button.js"),require("kendo.appbar.js"),require("kendo.html.button.js"),require("kendo.textarea.js"),require("kendo.speechtotextbutton.js"),require("kendo.upload.js"),require("kendo.core.js"),require("kendo.toolbar.js"),require("kendo.dropdownbutton.js"),require("kendo.menu.js"),require("kendo.data.js")):"function"==typeof define&&define.amd?define(["exports","kendo.textbox.min","kendo.licensing.min","kendo.avatar.min","kendo.icons.min","kendo.button.min","kendo.appbar.min","kendo.html.button.min","kendo.textarea.min","kendo.speechtotextbutton.min","kendo.upload.min","kendo.core.min","kendo.toolbar.min","kendo.dropdownbutton.min","kendo.menu.min","kendo.data.min"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).kendo=e.kendo||{},e.kendo._globals=e.kendo._globals||{},e.kendo._globals.Chat={}),e.kendo._globals.Textbox,e.kendo._globals.Licensing)}(this,(function(e,t,s){const n="object";const i=".";const o="click";const a="focus";const r="blur";const l="change";const d="rtl";const c=13,h=38,p=40,g=35,u=36,m=32;const f={AMP:/&/g,LT:/</g,GT:/>/g,QUOTE:/"/g,APOSTROPHE:/'/g,CURLY:/__CURLY__/g,SHARP:/__SHARP__/g,ARGUMENT_NAME:/^\w+/,ENCODE:/\$\{([^}]*)\}/g,ESCAPED_CURLY:/\\\}/g,ESCAPED_SHARP:/\\#/g,EDGE:/(edge)[ /]([\w.]+)/i,WEBKIT:/(chrome|crios)[ /]([\w.]+)/i,SAFARI:/(webkit)[ /]([\w.]+)/i,OPERA:/(opera)(?:.*version|)[ /]([\w.]+)/i,MSIE:/(msie\s|trident.*? rv:)([\w.]+)/i,MOZILLA:/(mozilla)(?:.*? rv:([\w.]+)|)/i,CHROMIUM_EDGE:/(edg)[ /]([\w.]+)/i};const b=e=>"function"==typeof e;const w=$.extend;function M(e,t){const s=kendo?.data?.ObservableArray;const i=kendo?.data?.LazyObservableArray;const o=kendo?.data?.DataSource;const a=kendo?.data?.HierarchicalDataSource;for(const r in t){if("__proto__"===r||"constructor"===r||"prototype"===r)continue;const l=t[r];const d=typeof l;let c=null;if(d===n&&null!==l&&(c=l.constructor),!c||c===Array||c===s||c===i||c===o||c===a||c===RegExp||b(globalThis.ArrayBuffer)&&c===ArrayBuffer||l instanceof HTMLElement)"undefined"!==d&&(e[r]=l);else if(l instanceof Date)e[r]=new Date(l.getTime());else if(b(l.clone))e[r]=l.clone();else{const t=e[r];e[r]=typeof t===n&&t||{},M(e[r],l)}}return e}const v=()=>{try{return crypto.randomUUID()}catch(e){k(`crypto.randomUUID is not supported. Using fallback method. ${e}`,"warn");return crypto.getRandomValues(new Uint8Array(16)).reduce(((e,t,s)=>(4!==s&&6!==s&&8!==s&&10!==s||(e+="-"),e+=t.toString(16).padStart(2,"0"))),"")}};const k=(e,t)=>{const s=window.console||console||{};!kendo.suppressLog&&void 0!==s&&s.log&&s[t||"log"](e)};const x=(e,t)=>(t?e:y(e)).replace(/((https?:\/\/[^\s]+)|(www\.[^\s]+))/gi,(e=>{let t=e.trim();const s=e.trim();/^www\./i.test(t)&&(t="https://"+t);try{t=new URL(t).href;let e="noopener noreferrer";return`<a href="${t}" target="${"_blank"}"${e?` rel="${e}"`:""}>${s}</a>`}catch(t){return e}}));const y=(e,t)=>{!0===t&&(e=function(e){const t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return e.replace(/&(?:amp|lt|gt|quot|#39);/g,(function(e){return t[e]}))}(e));return(""+e).replace(f.AMP,"&amp;").replace(f.LT,"&lt;").replace(f.GT,"&gt;").replace(f.QUOTE,"&quot;").replace(f.APOSTROPHE,"&#39;")};const _={audio:[".aif",".iff",".m3u",".m4a",".mid",".mp3",".mpa",".wav",".wma",".ogg",".wav",".wma",".wpl"],video:[".3g2",".3gp",".avi",".asf",".flv",".m4u",".rm",".h264",".m4v",".mkv",".mov",".mp4",".mpg",".rm",".swf",".vob",".wmv"],image:[".ai",".dds",".heic",".jpe","jfif",".jif",".jp2",".jps",".eps",".bmp",".gif",".jpeg",".jpg",".png",".ps",".psd",".svg",".svgz",".tif",".tiff"],txt:[".doc",".docx",".log",".pages",".tex",".wpd",".wps",".odt",".rtf",".text",".txt",".wks"],presentation:[".key",".odp",".pps",".ppt",".pptx"],data:[".xlr",".xls",".xlsx"],programming:[".tmp",".bak",".msi",".cab",".cpl",".cur",".dll",".dmp",".drv",".icns",".ico",".link",".sys",".cfg",".ini",".asp",".aspx",".cer",".csr",".css",".dcr",".htm",".html",".js",".php",".rss",".xhtml"],pdf:[".pdf"],config:[".apk",".app",".bat",".cgi",".com",".exe",".gadget",".jar",".wsf"],zip:[".7z",".cbr",".gz",".sitx",".arj",".deb",".pkg",".rar",".rpm",".tar.gz",".z",".zip",".zipx"],"disc-image":[".dmg",".iso",".toast",".vcd",".bin",".cue",".mdf"]};const C=(e,t)=>{const s=Object.keys(_);const n="file";if(void 0===e||!e.length)return n;for(let n=0;n<s.length;n+=1){const i=_[s[n]];const o=e.toLowerCase();if(i.indexOf(o)>-1||i.indexOf("."+o)>-1)return t?"file-"+s[n]:s[n]}return n};const T=(e,t)=>{const s=(e=>{let t={};let s=[];let n=[];const i={edge:f.EDGE,webkit:f.WEBKIT,safari:f.SAFARI,opera:f.OPERA,msie:f.MSIE,mozilla:f.MOZILLA};for(let o in i)if(i.hasOwnProperty(o)&&(s=e.match(i[o]),s)){t[o]=!0,t[s[1].toLowerCase().split(" ")[0].split("/")[0]]=!0,t.version=parseInt(document.documentMode||s[2],10),t.chrome&&(n=e.match(f.CHROMIUM_EDGE),n&&(t.chromiumEdge=!0));break}return t})(navigator.userAgent);const n=s.webkit;const i=s.mozilla;const o=s.safari;const a=s.version;let r,l;if(e instanceof $&&void 0!==t)e.each((function(e,s){T(s,t)}));else if(r=e instanceof $?e[0]:e,r){if(l=(e=>$(e).closest(".k-rtl").length>0)(e),void 0===t){let e;return e=l&&n&&(a<85||o)?r.scrollWidth-r.clientWidth-r.scrollLeft:Math.abs(r.scrollLeft),e}r.scrollLeft=l&&n&&(a<85||o)?r.scrollWidth-r.clientWidth-t:l&&(i||n)&&t>0?-t:t}};const S=(e,t)=>{let s=T(e);const n={scrollLeft:s+t};e.finish().animate(n,"fast","linear");const i=e[0].scrollWidth-e[0].clientWidth;const o=Math.min(Math.max(s+t,0),i);return{atStart:0===o,atEnd:o>=i}};const B="function";const A="string";const I="aria-labelledby";const D="aria-label";const E=["themeColor","fillMode","shape","size","rounded","positionMode"];class O{constructor(){this.constructor._extendSetupDone||this._setupExtendedClass()}_setupExtendedClass(){this.constructor.extend=O.extend,this.constructor.fn=this.constructor.prototype,this.constructor._extendSetupDone=!0}static extend(e){const t=this;class s extends t{constructor(...t){e.init?(super(),e.init.apply(this,t)):super(...t)}}for(const n in e)"init"!==n&&(null!=e[n]&&e[n].constructor===Object?s.prototype[n]={...t.prototype[n],...e[n]}:s.prototype[n]=e[n]);return s.extend=this.extend,s.fn=s.prototype,s}_initOptions(e){this.options=((e,...t)=>{for(let s=0;s<t.length;s++)M(e,t[s]);return e})({},this.options,e)}}const P=function(){this._defaultPrevented=!0};const L=function(){return!0===this._defaultPrevented};class F extends O{constructor(){super(),this._events={}}bind(e,t,s){if(void 0===t){for(const t in e)this.bind(t,e[t]);return this}const n=typeof e===A?[e]:e;const i=typeof t===B;for(let e=0;e<n.length;e++){const o=n[e];let a=i?t:t[o];if(a){if(s){const e=a;a=(...t)=>{this.unbind(o,a),e.apply(this,t)},a.original=e}(this._events[o]=this._events[o]||[]).push(a)}}return this}one(e,t){return this.bind(e,t,!0)}first(e,t){const s=typeof e===A?[e]:e;const n=typeof t===B;for(let e=0;e<s.length;e++){const i=s[e];const o=n?t:t[i];if(o){(this._events[i]=this._events[i]||[]).unshift(o)}}return this}trigger(e,t={}){const s=this._events[e];if(s){t.sender=this,t._defaultPrevented=!1,t.preventDefault=P,t.isDefaultPrevented=L;const e=s.slice();for(let s=0;s<e.length;s++)e[s].call(this,t);return!0===t._defaultPrevented}return!1}unbind(e,t){if(void 0===e)this._events={};else{const s=this._events[e];if(s)if(t)for(let e=s.length-1;e>=0;e--)s[e]!==t&&s[e].original!==t||s.splice(e,1);else this._events[e]=[]}return this}}class U extends F{constructor(e,t){super(),void 0===s.validatePackage||s.validatePackage()||(this._showWatermarkOverlay=s.addWatermarkOverlayAndBanner),this.element=(kendo?.jQuery||$)?.(e),this.element?.handler&&this.element.handler(this);const n=t?.dataSource;let i;t&&(i=(this.componentTypes||{})[t.componentType]),n&&(t={...t,dataSource:{}}),this.options={...this.options,...this.defaults,...i,...t},n&&(this.options.dataSource=n),kendo?.attr&&!this.element?.attr?.(kendo.attr("role"))&&this.element?.attr?.(kendo.attr("role"),(this.options.name||"").toLowerCase()),this.element?.data?.("kendo"+this.options.prefix+this.options.name,this),this.bind(this.events,this.options)}get events(){return[]}get options(){return this._options||{prefix:""}}set options(e){this._options=e}_hasBindingTarget(){return!!this.element?.[0]?.kendoBindingTarget}_tabindex(e){e=e||this.wrapper;const t=this.element;const s="tabindex";const n=e?.attr?.(s)||t?.attr?.(s);t?.removeAttr?.(s),e?.attr?.(s,isNaN(n)?0:n)}setOptions(e){this._clearCssClasses(e),this._setEvents(e),Object.assign(this.options,e),this._applyCssClasses()}_setEvents(e){for(let t=0;t<this.events.length;t++){const s=this.events[t];this.options[s]&&e[s]&&(this.unbind(s,this.options[s]),this._events?.[s]&&delete this._events[s])}this.bind(this.events,e)}resize(e){const t=this.getSize();const s=this._size;(e||(t.width>0||t.height>0)&&(!s||t.width!==s.width||t.height!==s.height))&&(this._size=t,this._resize(t,e),this.trigger("resize",t))}getSize(){return kendo?.dimensions?.(this.element)||{width:0,height:0}}size(e){if(!e)return this.getSize();this.setSize(e)}setSize(){}_resize(){}destroy(){this.element?.removeData?.("kendo"+this.options.prefix+this.options.name),this.element?.removeData?.("handler"),this.unbind()}_destroy(){this.destroy()}_applyCssClasses(e){const t=Object.getPrototypeOf(this).constructor.prototype.options;const s=this.options;const n=e||this.wrapper||this.element;const i=[];if(kendo?.cssProperties?.propertyDictionary?.[t?.name]){for(let e=0;e<E.length;e++){const n=E[e];const o=this.options._altname||t.name;if(t.hasOwnProperty(n))if("themeColor"===n){const e=kendo.cssProperties.getValidClass({widget:o,propName:"fillMode",value:s.fillMode});e?.length&&i.push(kendo.cssProperties.getValidClass({widget:o,propName:n,value:s[n],fill:s.fillMode}))}else i.push(kendo.cssProperties.getValidClass({widget:o,propName:n,value:s[n]}))}n?.addClass?.(i.join(" "))}}_ariaLabel(e){const t=this.element;const s=t?.attr?.("id");const n=$?.(`label[for="${s}"]`);const i=t?.attr?.(D);const o=t?.attr?.(I);if(e?.[0]!==t?.[0])if(i)e?.attr?.(D,i);else if(o)e?.attr?.(I,o);else if(n?.length){const t=n?.attr?.("id")||this._generateLabelId(n,s||kendo?.guid?.());e?.attr?.(I,t)}}_clearCssClasses(e,t){const s=Object.getPrototypeOf(this).constructor.prototype.options;const n=this.options;const i=t||this.wrapper||this.element;if(kendo?.cssProperties?.propertyDictionary?.[s?.name])for(let t=0;t<E.length;t++){const o=E[t];const a=this.options._altname||s.name;s.hasOwnProperty(o)&&e.hasOwnProperty(o)&&("themeColor"===o?i?.removeClass?.(kendo.cssProperties.getValidClass({widget:a,propName:o,value:n[o],fill:n.fillMode})):("fillMode"===o&&i?.removeClass?.(kendo.cssProperties.getValidClass({widget:a,propName:"themeColor",value:n.themeColor,fill:n.fillMode})),i?.removeClass?.(kendo.cssProperties.getValidClass({widget:a,propName:o,value:n[o]}))))}}_generateLabelId(e,t){const s=t+"_label";return e?.attr?.("id",s),s}}class R extends U{dataItems(){return this.dataSource?this.dataSource.flatView():[]}}O.fn=O.prototype,F.fn=F.prototype,U.fn=U.prototype,R.fn=R.prototype;const z=Array.prototype.slice;const j=".kendoChat";const H="k-active",N="k-chat-file",G="k-chat-file-info",W="k-chat-file-name",q="k-chat-file-size",V="k-chat-file-wrapper",K="k-bubble",Q="k-bubble-content",Y="k-bubble-expandable",Z="k-bubble-expandable-indicator",J="k-button-icon",X="k-chat-bubble",ee="k-chat-bubble-text",te="k-chat-send",se="k-disabled",ne="k-chat-download-button",ie="k-chat-download-button-wrapper",oe="k-expanded",ae="k-generating",re="k-chat-header",le="k-hidden",de="k-message",ce="k-message-author",he="k-message-box",pe="k-message-box-wrapper",ge="k-message-group",ue="k-message-group-content",me="k-message-group-full-width",fe="k-message-group-receiver",be="k-message-group-sender",we="k-avatars",Me="k-message-list-content",ve="k-message-pinned",ke="k-message-reference",xe="k-message-reference-content",ye="k-message-reference-receiver",_e="k-message-reference-sender",Ce="k-message-removed",Te="k-message-time",$e="k-chat-message-toolbar",Se="k-no-avatar",Be="k-selected",Ae="k-focus",Ie="k-spacer",De="k-suggestion",Ee="k-suggestion-group",Oe="k-suggestion-scrollwrap",Pe="k-timestamp",Le="k-typing-indicator",Fe="k-message-list",Ue="k-chat";const Re="paperclip",ze="more-vertical",je="chevron-down",He="chevron-left",Ne="chevron-right",Ge="chevron-up",We="download",qe="pin",Ve="undo",Ke="copy",Qe="trash",Ye="paper-plane",Ze="stop-sm",Je="x";const Xe="ref-chat-file-button",et="ref-chat-file-menu-button",tt="ref-chat-file-wrapper",st="ref-chat-file-close-button",nt="ref-chat-bubble-expandable-indicator",it="ref-chat-message-reference-pin-wrapper",ot="ref-chat-message-reference-reply-wrapper",at="ref-chat-pinned-message-close-button",rt="ref-chat-reply-message-close-button",lt="ref-chat-left-scroll-button",dt="ref-chat-right-scroll-button",ct="ref-chat-message-box-send-button",ht="ref-chat-message-box-speech-to-text-button",pt="ref-chat-suggestion-group",gt="ref-chat-file-upload-input";const ut="sendMessage",mt="suggestionClick",ft="unpin",bt="input",wt="toolbarAction",Mt="fileMenuAction",vt="contextMenuAction",kt="download";const xt="standard",yt="full";const _t="reply",Ct="copy",Tt="pin",$t="delete",St="download";const Bt=200;const At=(e,t,s=!0)=>{return`<li class="${N}" data-uid="${y(e.uid)}">\n            ${kendo.ui.icon({icon:C(e.extension,!0),size:"xxlarge"})}\n            <div class="${G}">\n                <span class="${W}">${y(e.name)}</span>\n                <span class="${q}">${y((n=e.size,isNaN(n)?n:(n/=1024)<1024?n.toFixed(2)+" KB":(n/1024).toFixed(2)+" MB"))}</span>\n            </div>\n            ${t?new kendo.ui.Button(`<button class="" ${st}>`,{icon:Je,fillMode:"flat"}).wrapper[0].outerHTML:""}\n            ${s&&!t?`<button ${et}></button>`:""}\n        </li>`;var n};const It=(e,t,s,n,i,o,a)=>{const r=e.isDeleted;const l=i&&!e.isTyping?[Y,oe]:[];const d=t?Ot({text:t.text,files:t.files,isOwnMessage:t.isOwnMessage,isPinMessage:!1,renderCloseButton:!1,renderFileMenuButton:!1}):"";let c="";return c=r?e.isOwnMessage?y(n.selfMessageDeleted):y(n.otherMessageDeleted):x(e.text||"",a),'<div class="'+de+(r?" "+Ce:"")+'" data-uid="'+y(e.uid)+'"><time class="'+Te+'">'+kendo.toString(kendo.parseDate(e.timestamp),o)+'</time><div class="'+X+" "+K+" "+l.join(" ")+'"><div class="'+Q+'"><span class="'+ee+'">'+d+(e.isTyping&&!e.isOwnMessage?'<div class="'+Le+'"><span></span><span></span><span></span></div>':c)+"</span>"+(r?"":Et(e.files,s,n))+"</div>"+(i&&!e.isTyping?'<span class="'+Z+'" '+nt+">"+kendo.ui.icon({icon:Ge})+"</span>":"")+"</div>"+(r?"":'<div class="'+$e+'"></div>')+"</div>"};const Dt=({message:e,author:t,isOwnMessage:s,replyMessage:n,downloadAll:i,messages:o,expandable:a,fullWidth:r,messageTimeFormat:l,timestampTemplate:d,showTimestamp:c,messageTemplate:h=It,skipSanitization:p})=>{const g=t&&t.imageUrl;const u=ge+" "+(s?be:fe)+(g?"":" "+Se)+(r?" "+me:"");let m="";if(c&&e.timestamp){const t=kendo.parseDate(e.timestamp);if(b(d))m=d({date:t,message:e});else{const e=((e,t=new Date)=>{if(!e)return"";const s=new Date(t);s.setHours(0,0,0,0);const n=new Date(e);n.setHours(0,0,0,0);const i=s.getTime()-n.getTime();const o=Math.floor(i/864e5);return 0===o?"Today":1===o?"Yesterday":o<=6?`Last ${kendo.toString(n,"dddd")}`:kendo.toString(n,"dddd, MMMM dd, yyyy")})(t);m='<div class="'+Pe+'">'+e+"</div>"}}return(c&&m?m:"")+'<div class="'+u+'">'+(g?(({url:e,text:t})=>new kendo.ui.Avatar("<div>",{type:"image",image:e,alt:y(t??"")}).wrapper[0].outerHTML)({url:t.imageUrl,text:t.imageAltText}):"")+'<div class="'+ue+'"><span class="'+ce+'">'+y(t.name)+"</span>"+h(e,n,i,o,a,l,p)+"</div></div>"};const Et=(e,t,s,n)=>{if(!e?.length)return"";let i=`<ul class="${V}" ${tt}>`;return e.forEach((e=>{i+=At(e,n,!0)})),i+="</ul>",t&&e.length>1&&(i+=`<div class="${ie}">\n            ${new kendo.ui.Button(`<button class="${ne}">${s.downloadAll}</button>`,{icon:We,fillMode:"flat"}).wrapper[0].outerHTML}\n        </div>`),i};const Ot=({text:e,files:t,isOwnMessage:s,isPinMessage:n,isDeleted:i,renderCloseButton:o,renderFileMenuButton:a,messages:r})=>{const l=s?_e:ye;const d=n?ve:"";const c=n?at:rt;const h=n?it:ot;let p=x(e||"");return p||(p=t?.length?At(t[0],null,a):""),i&&(p=y(s?r.selfMessageDeleted:r.otherMessageDeleted)),'<div class="'+ke+" "+l+" "+d+'" '+h+">"+(n?kendo.ui.icon({icon:qe,size:"xlarge"}):"")+'<div class="'+xe+'">'+p+'</div><span class="'+Ie+'"></span>'+(o?new kendo.ui.Button("<button "+c+">",{icon:Je,fillMode:"flat"}).wrapper[0].outerHTML:"")+"</div>"};const Pt=e=>e?.length?`<div class="${Ee}" ${pt}>${e.map((e=>`<span class="${De}">${y(e.text)}</span>`)).join("")}</div>`:"";const Lt=(e,t)=>'<div class="'+Oe+'">'+new kendo.ui.Button("<button "+lt+">",{icon:t?Ne:He}).wrapper[0].outerHTML+e+new kendo.ui.Button("<button "+dt+">",{icon:t?He:Ne}).wrapper[0].outerHTML+"</div>";const Ft=`${j}navigation`;let Ut=null;let Rt=!1;const zt=(e,t)=>{const s=t.messages;const n=e.find(`.${we}`);n.length&&n.attr("role","log").attr("aria-live","polite").attr("aria-label",s.messageListLabel),jt(e);e.find(`.${Ee}`).each(((e,t)=>{const s=$(t);s.attr("role","group");s.find(`.${De}`).each(((e,t)=>{$(t).attr("role","button").attr("tabindex","0")}))}));e.find(".k-input-suffix > .k-button").each(((e,t)=>{const n=$(t);n.attr("role")||"button"===n[0].nodeName.toLowerCase()||n.attr("role","button"),n.attr("aria-label")||n.attr("title")||(n.hasClass(te)?n.attr("aria-label",s.sendButton):n.hasClass("k-chat-upload")&&n.attr("aria-label",s.fileButton)),n.hasClass(te)&&n.hasClass("k-disabled")&&n.attr("aria-disabled","true")}));e.find(`.${ne}`).each(((e,t)=>{const n=$(t);n.attr("role")||"button"===n[0].nodeName.toLowerCase()||n.attr("role","button"),n.attr("aria-label")||n.attr("title")||n.attr("aria-label",s.downloadAll)}));e.find(`[${at}]`).each(((e,s)=>{const n=$(s);n.attr("role")||"button"===n[0].nodeName.toLowerCase()||n.attr("role","button"),n.attr("aria-label")||n.attr("title")||(n.attr("aria-label",t.messages.pinnedMessageCloseButton),n.attr("title",t.messages.pinnedMessageCloseButton))})),Kt(e,t);e.find(`[${et}]`).each(((e,s)=>{const n=$(s);n.attr("aria-label",t.messages.fileMenuButton),n.attr("title",t.messages.fileMenuButton)}));e.find(`.${Z}`).each(((e,t)=>{const s=$(t);s.attr("role","button").attr("tabindex","0");const n=s.closest(`.${K}`).hasClass(oe)?"Collapse message":"Expand message";s.attr("aria-label",n)})),Qt(e);e.find(`.${he}`).find("textarea").attr("aria-label",s.messageBoxLabel)};const jt=e=>{const t=e.find(`.${K}`);const s=t.filter((function(){return 0===$(this).find(`.${Le}`).length}));const n=t.filter((function(){return $(this).find(`.${Le}`).length>0}));s.attr("tabindex","0"),n.attr("tabindex","-1"),s.off(`${a}${Ft} ${r}${Ft} ${o}${Ft}`).on(`${a}${Ft}`,(function(){const e=$(this);Ut&&t.removeClass(Be),t.removeClass(Ae),Ut&&e.addClass(Be),e.addClass(Ae),Ut=!1})).on(`${r}${Ft}`,(function(){Ut&&!Rt&&$(this).removeClass(Be),$(this).removeClass(Ae)})).on(`${o}${Ft}`,(function(e){$(e.target).closest(et)||$(this).trigger(a)}))};const Ht=(e,t)=>{const s=t?"Collapse message":"Expand message";e.attr("aria-label",s)};const Nt=(e,t)=>{if(0===e.length||t<0||t>=e.length)return;const s=e.eq(t);s.attr("data-keyboard-focus","true"),s.focus(),s.removeAttr("data-keyboard-focus")};const Gt=(e,t,s)=>{const n=$(e.target);if(n.find(`.${Le}`).length>0)return null;const i=s.find(`.${K}`).filter((function(){return 0===$(this).find(`.${Le}`).length}));const o=i.index(n);switch(t){case h:e.preventDefault(),((e,t)=>{t>0&&Nt(e,t-1)})(i,o);break;case p:e.preventDefault(),((e,t)=>{t<e.length-1&&Nt(e,t+1)})(i,o);break;case u:e.preventDefault(),(e=>{Nt(e,0)})(i);break;case g:e.preventDefault(),(e=>{Nt(e,e.length-1)})(i)}return null};const Wt=(e,t)=>{if(t===c||t===m){e.preventDefault(),$(e.target).trigger(o);const t=$(e.target);const s=t.closest(`.${K}`).hasClass(oe);Ht(t,!s)}};const qt=(e,t,s,n)=>{t!==c||e.shiftKey||(e.preventDefault(),n._sendMessage())};const Vt=(e,t)=>{t!==c&&t!==m||(e.preventDefault(),$(e.target).trigger(o))};const Kt=(e,t)=>{e.find(`[${rt}]`).each(((e,s)=>{const n=$(s);n.attr("role")||"button"===n[0].nodeName.toLowerCase()||n.attr("role","button"),n.attr("aria-label")||n.attr("title")||(n.attr("aria-label",t.messages.replyMessageCloseButton),n.attr("title",t.messages.replyMessageCloseButton))}))};const Qt=e=>{const t=e.find(`[${lt}]`);const s=e.find(`[${dt}]`);t.attr("aria-label","Scroll Left"),t.attr("title","Scroll Left"),s.attr("aria-label","Scroll Right"),s.attr("title","Scroll Right")};class Yt extends U{static options={name:"MessageBox"};constructor(e,t){super(e,w(!0,{},Yt.options,t)),this.chatElement=t.chatElement,this._files=[],this._generating=!1,this._wrapper(),this._initTextArea(),!1!==t.fileAttachment&&this._initUpload(),!1!==t.speechToText&&this._initSpeechToTextButton(),this._attachEvents(),this._typing=!1,this._files=[]}_wrapper(){const e=this.options;const t=e.suggestionsTemplate(e.suggestions);if(this.wrapper=$(`<div class="${pe}"></div>`),e.suggestions.length){const s=e.suggestionsScrollable?Lt(t,"rtl"===e.dir):t;this.suggestions=this.wrapper.append(s)}this.wrapper.find(`[${lt}]`).addClass(se),this.chatElement.append(this.wrapper)}updateAttachmentList(){const e=this.getAttachmentListContainer();const t=this.options.filesTemplate(this._files,!1,{},!0);0===e.length?this.textAreaInstance._prefixContainer.append(t):e.replaceWith(t),this.textAreaInstance._prefixContainer.find(`[${st}]`).each(((e,t)=>{const s=$(t);s.attr("role")||"button"===s[0].nodeName.toLowerCase()||s.attr("role","button"),s.attr("aria-label")||s.attr("title")||(s.attr("aria-label","Remove selected file"),s.attr("title","Remove selected file"))})),this.toggleSendButton(this._files.length>0)}getAttachmentListContainer(){return this.textAreaInstance._prefixContainer.find(`[${tt}]`)}clearAttachmentList(){this._files=[];const e=this.getAttachmentListContainer();e.length>0&&e.remove(),this.toggleSendButton(!1)}setReplyMessage(e,t){const s=this.getReplyMessageContainer();const n=this.options.messageReferenceTemplate({text:e.text,files:e.files,isOwnMessage:t,renderCloseButton:!0,renderFileMenuButton:!1});0===s.length?this.textAreaInstance._prefixContainer.prepend(n):s.replaceWith(n)}removeReplyMessage(){const e=this.getReplyMessageContainer();e.length>0&&e.remove()}getReplyMessageContainer(){return this.textAreaInstance._prefixContainer.find(`[${ot}]`)}toggleSendButton(e){const t=this.wrapper.find(`[${ct}]`);e?t.removeClass(se):this._generating||t.addClass(se)}toggleSendButtonGenerating(e){const t=this.wrapper.find(`[${ct}]`);t.toggleClass(ae,e).toggleClass(se,!e),this._generating=e,e?(t.attr("aria-disabled",!1),t.html(kendo.ui.icon({icon:Ze,iconClass:J}))):(t.attr("aria-disabled",!0),t.html(kendo.ui.icon({icon:Ye,iconClass:J})))}_attachEvents(){this.element.on("input"+j,this._input.bind(this)),this.wrapper.on(o+j,`[${ct}]`,this._sendButtonClick.bind(this)).on(o+j,`[${Xe}]`,this._fileButtonClick.bind(this)).on(o+j,`[${rt}]`,this._replyMessageCloseButtonClick.bind(this)).on(o+j,`[${pt}]`,this._suggestionClick.bind(this)).on(o+j,`[${lt}]`,this._leftScrollButtonClick.bind(this)).on(o+j,`[${dt}]`,this._rightScrollButtonClick.bind(this)).on(o+j,`[${st}]`,this._fileCloseButtonClick.bind(this))}_initTextArea(){const e=this.options;const t=e.messages||{};const s="inputId_"+v();const n=!1!==e.speechToText;const i=!1!==e.fileAttachment;const o=this.element.kendoTextArea({resize:"auto",maxRows:5,placeholder:t.placeholder,suffixOptions:{template:()=>(({messages:e,speechToTextButtonEnabled:t,fileAttachmentButtonEnabled:s})=>{const n=t?`<button title="${e.speechToTextButton}" aria-label="${e.speechToTextButton}" ${ht}></button>`:"";const i=s?kendo.html.renderButton(`<button title="${e.fileButton}" aria-label="${e.fileButton}" ${Xe}></button>`,{icon:Re,size:"medium",fillMode:"clear"}):"";const o=kendo.html.renderButton(`<button title="${e.sendButton}" aria-label="${e.sendButton}" class="${te} ${se}" ${ct}></button>`,{icon:Ye,size:"medium",rounded:"full",fillMode:"solid",themeColor:"primary"});return n+i+(s?`<input type="file" ${gt} id="input_${v()}" class="k-hidden" />`:"")+`<span class="${Ie}"></span>`+o})({messages:t,speechToTextButtonEnabled:n,fileAttachmentButtonEnabled:i}),separator:!1},prefixOptions:{template:()=>"",separator:!1}}).data("kendoTextArea");o.element.attr("id",s),o.wrapper.addClass(he).appendTo(this.wrapper),this.textAreaInstance=o}_initUpload(){const e=this.wrapper.find(`[${gt}]`).kendoUpload({multiple:!0,async:!1,uniqueFileUids:!0,select:this._uploadSelect.bind(this)}).data("kendoUpload");e.wrapper.addClass(le),this.uploadInstance=e}_uploadSelect(e){e.preventDefault();const t=e.files;this._files=[...this._files,...t],this.updateAttachmentList()}_initSpeechToTextButton(){const e=this.options;const t={fillMode:"clear",result:this._speechToTextResult.bind(this)};const s=typeof(i=e.speechToText)===n&&null!==i?{...t,...e.speechToText}:t;var i;this.speechToTextButtonInstance=this.wrapper.find(`[${ht}]`).kendoSpeechToTextButton(s).data("kendoSpeechToTextButton")}_speechToTextResult(e){const t=this.textAreaInstance;let s=t.value();let n="";e.alternatives&&e.alternatives[0]&&(n=e.alternatives[0].transcript,s+=" "+n,t.value(s)),s.length>0&&this.toggleSendButton(!0)}_input(){const e=this.element.val();const t=e.length>0;this.toggleSendButton(t),this.trigger("input",{value:e})}_sendButtonClick(e){e.preventDefault(),this._sendMessage()}_fileButtonClick(e){e.preventDefault(),this.trigger("fileButtonClick")}_fileCloseButtonClick(e){e.preventDefault();const t=$(e.currentTarget).closest(`${i}${N}`).data("uid");this._files=this._files.filter((e=>e.uid!==t)),this.updateAttachmentList()}_replyMessageCloseButtonClick(e){e.preventDefault(),this.trigger("replyMessageCloseButtonClick")}_suggestionClick(e){e.preventDefault();const t=$(e.target).closest(i+De).text();this.trigger("suggestionClick",{text:t}),this.textAreaInstance.value(t),this.toggleSendButton(!0)}_sendMessage(){const e=this.element.val();if(this._generating)return void this.trigger("sendMessage",{generating:!0});if(!e.length&&!this._files?.length)return;const t={text:e,files:this._files};this.trigger("sendMessage",t),this.textAreaInstance.value(""),this.textAreaInstance.updateAutoHeight(),this.clearAttachmentList()}_leftScrollButtonClick(e){e.preventDefault();const t=$(e.currentTarget);const s=this.wrapper.find(`${i}${Ee}`);const n=this.options.dir===d;const o=S(s,n?Bt:-200);this.wrapper.find(`[${dt}]`).removeClass(se),(n?o.atEnd:o.atStart)&&t.addClass(se)}_rightScrollButtonClick(e){e.preventDefault();const t=$(e.currentTarget);const s=this.wrapper.find(`${i}${Ee}`);const n=this.options.dir===d;const o=S(s,n?-200:Bt);this.wrapper.find(`[${lt}]`).removeClass(se),(n?o.atStart:o.atEnd)&&t.addClass(se)}destroy(){this.textAreaInstance&&this.textAreaInstance.destroy(),this.speechToTextButtonInstance&&this.speechToTextButtonInstance.destroy(),this.wrapper.remove()}}class Zt extends U{static options={name:"MessageToolbar"};constructor(e,t){super(e,w(!0,{},Zt.options,t)),this.extendItemsConfig(),this.create(),this.attachEvents()}create(){this.element.data("kendoMessageToolbar")&&this.destroy(),this.toolbar=new kendo.ui.ToolBar(this.element,this.options)}extendItemsConfig(){this.options.items&&this.options.items.forEach((e=>{e.attributes=e.attributes||{};let t=e.attributes["aria-label"];e.attributes["data-command"]=e.name.toLowerCase(),e.attributes["aria-label"]=t??e.name,e.type="button",e.fillMode="flat",e.overflow="never"}))}destroy(){this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.element.empty()}attachEvents(){this.toolbar.bind(o,this.onClick.bind(this))}onClick(e){const t=e.target.closest(i+de);const s=e.target.data("command");s&&this.executeCommand(s,e.target,t)}executeCommand(e,t,s){this.trigger("execute",{type:e,item:t,message:s})}}class Jt extends U{static options={name:"ChatFileMenu",items:[]};constructor(e,t){super(e,w(!0,{},Jt.options,t)),this.setCommandAttributes(),this.createDropdownButton()}createDropdownButton(){this.dropdownButton=new kendo.ui.DropDownButton(this.element,{items:this.options.items,fillMode:"flat",icon:ze}),this.dropdownButton.bind("click",this.onClick.bind(this)).bind("open",this.onOpen.bind(this)).bind("close",this.onClose.bind(this))}setCommandAttributes(){this.options.items.forEach((e=>{e.attributes=e.attributes||{},e.attributes["data-command"]=e.name.toLowerCase(),e.id=e.name.toLowerCase()}))}destroy(){this.dropdownButton&&(this.dropdownButton.destroy(),this.dropdownButton=null),super.destroy()}onClick(e){const t=e.id;const s=$(e.sender.element).closest(i+N);const n=$(e.sender.element).closest(i+de);t&&this.executeCommand(t,$(e.sender.element),s,n)}onOpen(e){let t=!0;const s=$(e.sender.element);(s.closest(i+Ce).length||s.find(i+Le).length)&&(e.preventDefault(),t=!1),this.setActive(s,t)}onClose(e){const t=$(e.sender.element);const s=t.closest(i+de);this.setActive(t,!1),this.trigger("close",{message:s})}executeCommand(e,t,s,n){this.trigger("execute",{type:e,item:t,file:s,message:n})}setActive(e,t){const s=e.closest(i+K);t?s.addClass(H):s.removeClass(H)}}class Xt extends U{static options={name:"ChatView"};constructor(e,t){super(e,w(!0,{},Xt.options,t)),this._dataManager=this.options.dataManager,this._list(),this._attachEvents()}get events(){return[]}destroy(){super.destroy(),this.element.find("[data-role='chatfilemenu']").each((function(){const e=$(this).data("kendoChatFileMenu");e&&e.destroy()})),this.element.empty(),this.element.off(j),this.list=null}_list(){this.element.addClass(we).attr("role","log").attr("aria-label",this.options.messages.messageListLabel),this.list=$("<div>").addClass(Me).appendTo(this.element)}_attachEvents(){this.element.on(o+j,this._listClick.bind(this)).on(o+j,i+de,this._messageClick.bind(this)).on(o+j,i+De,this._suggestionClick.bind(this)).on(o+j,`[${lt}]`,this._leftScrollButtonClick.bind(this)).on(o+j,`[${dt}]`,this._rightScrollButtonClick.bind(this)).on(o+j,i+ne,this._downloadAllClick.bind(this))}renderMessage(e){const t=this.options.messages;const s=this.options.allowMessageCollapse;const n=this.options.messageWidthMode===yt;const i={id:e.authorId,name:e.authorName,imageUrl:e.authorImageUrl,imageAltText:e.authorImageAltText};const o=i.id===this.options.authorId;const a=this.getReplyMessage(e);const r=this.options.messageTimeFormat;const l=this.options.skipSanitization;if(this._handleExistingMessageUpdate({message:e,author:i,isOwnMessage:o,replyMessage:a,componentMessages:t,expandable:s,messageTimeFormat:r,skipSanitization:l}))return;const d=this._findTargetMessageGroup();if(this._canGroupWithLastMessage(d,i.id)&&d.length)this._addMessageToExistingGroup({message:e,author:i,isOwnMessage:o,replyMessage:a,componentMessages:t,expandable:s,targetGroupElement:d,messageTimeFormat:r,skipSanitization:l});else{const d=this._shouldShowTimestamp(e);this._createNewMessageGroup({message:e,author:i,isOwnMessage:o,replyMessage:a,componentMessages:t,expandable:s,fullWidth:n,messageTimeFormat:r,showTimestamp:d,skipSanitization:l})}}_shouldShowTimestamp(e){if(!e.timestamp)return!1;const t=this.list.find(i+de).filter((function(){return 0===$(this).find(i+Le).length})).last();if(!t.length)return!0;const s=this.dataItem(t);if(!s||!s.timestamp)return!0;const n=kendo.parseDate(e.timestamp);const o=kendo.parseDate(s.timestamp);if(!n||!o)return!1;const a=new Date(n);a.setHours(0,0,0,0);const r=new Date(o);return r.setHours(0,0,0,0),a.getTime()!==r.getTime()}_initMessageToolbar(e){const t=this.options;const s=t.messageToolbarActions;if(!s||!s.length||!e.length)return void e.remove();new Zt(e,{items:s,dir:t.dir,messages:t.messages,resizable:!1}).bind("execute",(e=>this.trigger("messageToolbarExecute",e)))}_initFileMenus(e){const t=this.options.fileActions;const s=e.find(`[${et}]`);t&&t.length&&e.length?s.each(((e,s)=>{const n=$(s);if(!n.data("kendoDropDownButton")){new Jt(n,{items:t}).bind("execute",(e=>this.trigger("fileMenuExecute",e)))}})):s.remove()}_handleExistingMessageUpdate({message:e,author:t,isOwnMessage:s,replyMessage:n,componentMessages:o,expandable:a,messageTimeFormat:r,skipSanitization:l}){const d=this.list.find(i+de+`[data-uid="${y(e.uid)}"]`);if(d.length){const c=this.options.messageTemplate;const h=$(c({...e,isOwnMessage:s,author:t},n,!0,o,a,r,l));return d.replaceWith(h),this._initMessageToolbar(h.find(i+$e)),this._initFileMenus(h),!0}return!1}_findTargetMessageGroup(){let e=this.list.children(i+ge).last();let t=e;const s=e.find(i+de);if(1===s.length){s.first().find(i+Le).length>0&&(t=e.prev(i+ge))}return t}_canGroupWithLastMessage(e,t){const s=e.find(i+de).filter((function(){return 0===$(this).find(i+Le).length})).last();const n=this.dataItem(s);return n&&n.authorId===t}_addMessageToExistingGroup({message:e,author:t,isOwnMessage:s,replyMessage:n,componentMessages:o,expandable:a,targetGroupElement:r,messageTimeFormat:l,skipSanitization:d}){const c=this.options.messageTemplate;const h=r.find(i+ue);const p=$(c({...e,isOwnMessage:s,author:t},n,!0,o,a,l,d));h.append(p),this._initMessageToolbar(p.find(i+$e)),this._initFileMenus(p),this._moveTypingIndicatorsToEnd()}_createNewMessageGroup({message:e,author:t,isOwnMessage:s,replyMessage:n,componentMessages:o,expandable:a,fullWidth:r,messageTimeFormat:l,showTimestamp:d=!1,skipSanitization:c}){const h=this.options.messageGroupTemplate;const p=this.options.timestampTemplate;const g=this.options.messageTemplate;const u=$(h({message:e,author:t,isOwnMessage:s,replyMessage:n,downloadAll:!0,messages:o,expandable:a,fullWidth:r,messageTimeFormat:l,timestampTemplate:p,showTimestamp:d,messageTemplate:g,skipSanitization:c}));return this.list.append(u),this._initMessageToolbar(u.find(i+$e)),this._initFileMenus(u),this._moveTypingIndicatorsToEnd(),u}_moveTypingIndicatorsToEnd(){const e=this;const t=this.options.messageGroupTemplate;const s=this.options.messageWidthMode===yt;e.list.find(i+de).filter((function(){return $(this).find(i+Le).length>0})).each((function(){const n=$(this);const o=n.closest(i+ge);if(1===o.find(i+de).length)o.detach().appendTo(e.list);else{n.remove();const i=e.dataItem(n);const o={id:i.authorId,name:i.authorName,imageUrl:i.authorImageUrl,imageAltText:i.authorImageAltText};const a=$(t({message:i,author:o,isOwnMessage:o.id===e.options.authorId,fullWidth:s,messageTimeFormat:e.options.messageTimeFormat,showTimestamp:!1,timestampTemplate:e.options.timestampTemplate,messageTemplate:e.options.messageTemplate}));e.list.append(a)}}))}dataItem(e){const t=e&&e.data("uid");return t?this._dataManager.getMessageByUid(t):null}fileDataItem(e,t){const s=t&&t.data("uid");return s?this._dataManager.getFileByUid(e,s):null}getReplyMessage(e){if(!e?.replyToId)return null;const t=this._dataManager.getMessageById(e.replyToId);return t.isOwnMessage=t?.authorId===this.options.authorId,t}renderSuggestedActions(){const e=this.options;const t=this._dataManager.getLastMessage()?.suggestedActions||[];const s=e.suggestedActionsTemplate(t);const n=e.suggestedActionsScrollable?Lt(s,"rtl"===e.dir):s;this._removeSuggestedActions(),this.list.append(t.length?n:""),this.list.find(`[${lt}]`).addClass(se)}removeMessage(e){const t=this.list.find(i+de+`[data-uid="${y(e)}"]`);if(!t.length)return!1;const s=t.closest(i+ge);return 1===s.find(i+de).length?s.remove():t.remove(),!0}clearMessages(){this.list.find(i+ge).remove(),this.list.find(i+Pe).remove(),this._removeSuggestedActions()}scrollToBottom(){this.element.scrollTop(this.element.prop("scrollHeight"))}scrollToMessage(e){if(!e)return!1;const t=this.list.find(i+de+`[data-uid="${y(e)}"]`);return!!t.length&&((e,t,s={})=>{if(!e.length||!t.length)return!1;const{duration:n=0,easing:i="linear",position:o="center",offset:a=0,onComplete:r}=s;const l=e.height();const d=e.scrollTop();const c=e.offset();const h=t.offset();const p=t.outerHeight();const g=h.top-c.top+d;let u;switch(o){case"top":u=g+a;break;case"bottom":u=g-l+p+a;break;default:u=g-l/2+p/2+a}const m=e[0].scrollHeight-e[0].clientHeight;return u=Math.min(Math.max(u,0),m),e.finish().animate({scrollTop:u},n,i,r),!0})(this.element,t,{position:"top"})}_leftScrollButtonClick(e){e.preventDefault();const t=$(e.currentTarget);const s=this.element.find(`${i}${Ee}`);const n=this.options.dir===d;const o=S(s,n?Bt:-200);this.element.find(`[${dt}]`).removeClass(se),(n?o.atEnd:o.atStart)&&t.addClass(se)}_rightScrollButtonClick(e){e.preventDefault();const t=$(e.currentTarget);const s=this.element.find(`${i}${Ee}`);const n=this.options.dir===d;const o=S(s,n?-200:Bt);this.element.find(`[${lt}]`).removeClass(se),(n?o.atStart:o.atEnd)&&t.addClass(se)}_removeSuggestedActions(){this.list.find(i+Ee).remove(),this.list.find(i+Oe).remove()}_listClick(e){const t=$(e.target);t.hasClass(de)||t.parents(i+de).length||this._clearSelection(t)}_suggestionClick(e){const t=$(e.currentTarget);t.length&&this.trigger("suggestedActionClick",{text:t.text()})}_messageClick(e){const t=$(e.target);const s=t.closest(`[${nt}]`);if(this._allowMessageClick(t))return;if(this._clearSelection(t),s.length){const e=s.closest(i+K);const t=e.hasClass(oe);return e.toggleClass(oe,!t),s.html(kendo.ui.icon({icon:t?je:Ge})),void this.trigger("expandableToggle",{indicator:s,isExpanded:!t})}$(e.currentTarget).find(i+K).addClass(Be)}_allowMessageClick(e){const t=[`[${et}]`,i+$e,i+Le,i+ne].join(", ");return e.closest(t).length>0||e.children(t).length>0||e.is(t)}_clearSelection(e){const t=this.element.find(i+Be);e.closest(`[${nt}]`).length||t.each(((e,t)=>{$(t).removeClass(Be)}))}_downloadAllClick(e){const t=$(e.currentTarget).closest(i+de);t.length&&this.trigger("downloadAllFiles",{messageElement:t})}_refreshDataManager(e){this._dataManager=e}}class es{static options={autoSync:!0,schema:{model:{id:"id",fields:{id:{type:"string"},text:{type:"string"},authorId:{type:"string"},authorName:{type:"string"},authorImageUrl:{type:"string"},authorImageAltText:{type:"string"},replyToId:{type:"string",defaultValue:null},isDeleted:{type:"boolean",defaultValue:!1},isPinned:{type:"boolean",defaultValue:!1},isTyping:{type:"boolean",defaultValue:!1},timestamp:{type:"date"},files:{parse:e=>e||[]}}}}};constructor(e){this.dataSource=this.createDataSource(e)}createDataSource(e){let t;return e.dataSource instanceof kendo.data.DataSource?this.options=w(!0,{},es.options,e.dataSource.options):e.dataSource instanceof Array?this.options=w(!0,{},es.options,{data:e.dataSource}):this.options=w(!0,{},es.options,e.dataSource),this.mapFields(this.options.schema.model.fields,e),t=kendo.data.DataSource.create(this.options),t}mapFields(e,t){const s={text:"textField",authorId:"authorIdField",authorName:"authorNameField",authorImageUrl:"authorImageUrlField",authorImageAltText:"authorImageAltTextField",id:"idField",timestamp:"timestampField",files:"filesField",replyToId:"replyToIdField",isDeleted:"isDeletedField",isPinned:"isPinnedField",isTyping:"isTypingField"};for(const n in e)e.hasOwnProperty(n)&&s[n]&&(e[n].from=t[s[n]])}removeMessage(e){return!!e&&(e.set("isDeleted",!0),!0)}updateMessage(e,t){if(!e)return null;e instanceof kendo.data.ObservableObject||(e=this.getMessageById(e.id));for(let s in t)t.hasOwnProperty(s)&&e.set(s,t[s]);return e}getMessageById(e){return e?this.dataSource.get(e):null}getMessageByUid(e){return this.dataSource.getByUid(e)}getFileByUid(e,t){if(!e||!t)return null;return e.files.find((e=>e.uid===t))||null}postMessage(e,t){let s;return"string"==typeof e&&(e={text:e}),s={timestamp:new Date,files:[],...e,authorId:e.authorId?.toString()||t},this.dataSource.add(s)}pinMessage(e){return!!e&&(this.getPinnedMessage()?.set("isPinned",!1),e.set("isPinned",!0))}clearPinnedMessage(){this.getPinnedMessage()?.set("isPinned",!1)}getPinnedMessage(){return this.dataSource.data().find((e=>e.isPinned))||null}getView(){return this.dataSource.view()}getDataSource(){return this.dataSource}getLastMessage(){const e=this.getView();return e.length?e[e.length-1]:null}}class ts extends U{static options={name:"ChatMessageMenu",filter:`${i}${X}`,dataSource:[],keyboardAlignToAnchor:!0};constructor(e,t){super(e,w(!0,{},ts.options,t)),this.setCommandAttributes(),this.create(),this.attachEvents()}create(){this.menu=new kendo.ui.ContextMenu(this.element,this.options)}destroy(){this.menu&&(this.menu.destroy(),this.menu=null,this.element.remove())}attachEvents(){this.menu.bind("select",this.onSelect.bind(this)).bind("open",this.onOpen.bind(this)).bind("close",this.onClose.bind(this))}setCommandAttributes(){this.options.dataSource.forEach((e=>{e.attr=e.attr||{},e.attr["data-command"]=e.name.toLowerCase()}))}onSelect(e){const t=$(e.item);const s=$(e.target).closest(i+de);const n=t.data("command");n&&this.executeCommand(n,t,s)}onOpen(e){let t=!0;const s=$(e.target);const n=$(e.event?.target).length?$(e.event.target):s;const o=s.closest(i+Ce).length>0;const a=s.find(i+Le).length>0;const r=n.closest(`[${et}]`).length>0;const l=s.closest(i+de);(o||a||r||!l.length)&&(e.preventDefault(),t=!1),s.toggleClass(H,t),this.trigger("open",{message:l})}onClose(e){const t=$(e.target);const s=t.closest(i+de);t.removeClass(H),this.trigger("close",{message:s})}executeCommand(e,t,s){this.trigger("execute",{type:e,item:t,message:s})}toggleDeleteVisibility(e){const t=this.element.find("[data-command='delete']");t.length&&t.toggleClass(le,!e)}}class ss extends U{static options={name:"Chat",autoBind:!0,allowMessageCollapse:!1,authorId:null,suggestionsScrollable:!1,suggestedActionsScrollable:!1,speechToText:!0,fileAttachment:!0,messageToolbarActions:[],messageActions:[{name:_t,text:"Reply",icon:Ve},{name:Ct,text:"Copy",icon:Ke},{name:Tt,text:"Pin",icon:qe},{name:$t,text:"Delete",icon:Qe}],fileActions:[{name:St,text:"Download",icon:We}],suggestions:[],headerItems:[],dir:"ltr",messageTimeFormat:"ddd MMM dd yyyy",width:null,height:null,messages:{messageListLabel:"Message list",placeholder:"Type a message...",sendButton:"Send message",speechToTextButton:"Toggle speech to text",fileButton:"Attach file",downloadAll:"Download all",selfMessageDeleted:"You removed this message.",otherMessageDeleted:"This message was removed by its sender.",stopGeneration:"Stop generation",messageBoxLabel:"Type your message here",pinnedMessageCloseButton:"Unpin message",replyMessageCloseButton:"Remove reply",fileMenuButton:"File menu"},messageWidthMode:xt,messageTemplate:It,messageGroupTemplate:Dt,messageReferenceTemplate:Ot,filesTemplate:Et,suggestionsTemplate:Pt,suggestedActionsTemplate:Pt,timestampTemplate:null,textField:"text",authorIdField:"authorId",authorNameField:"authorName",authorImageUrlField:"authorImageUrl",authorImageAltTextField:"authorImageAltText",idField:"id",timestampField:"timestamp",filesField:"files",replyToIdField:"replyToId",isDeletedField:"isDeleted",isPinnedField:"isPinned",isTypingField:"isTyping",skipSanitization:!1};static mergeContextMenuActions(e,t,s){const n=e[s];if(Array.isArray(n)){const i=t[s]||[];const o={};for(const e of i)o[e.name]={...e};e[s]=n.map((e=>e.name in o?{...o[e.name],...e}:{...e}))}else e[s]=t[s]||[]}constructor(e,t,s){t=t||{},ss.mergeContextMenuActions(t,ss.options,"messageActions"),ss.mergeContextMenuActions(t,ss.options,"fileActions"),super(e,w(!0,{},ss.options,t)),this.options.messageActions=t.messageActions,this.options.fileActions=t.fileActions,s&&(this._events=s),this._init(t),kendo.notify(this)}get events(){return[ut,mt,ft,bt,wt,Mt,vt,kt]}_init(e){this.currentMessageReplyId=null,this._hasHeader=!!e.headerItems?.length,this._user(),this._wrapper(),this._dataSource(),this._view(),this.options.autoBind&&this.dataSource.fetch(),e?.toolbar&&k("The 'toolbar' option has been deprecated.","warn"),this._messageBox(),this._createMenus(),this._attachEvents(),zt(this.wrapper,this.options),jt(this.wrapper),this.scrollToBottom()}setOptions(e){super.setOptions(e),this.destroy(),this._init(e)}destroy(){this.dataSource&&(this._unbindDataSource(),this.dataSource=null),this.view&&(this.view.unbind(),this.view.destroy(),this.view=null),this.messageBox&&(this.messageBox.unbind(),this.messageBox.destroy(),this.messageBox=null),this.messageContextMenu&&this.messageContextMenu.destroy(),this.wrapper&&(this.wrapper.off(),this.wrapper.empty(),this.wrapper=null),super.destroy()}_attachEvents(){const e=this;this.view.bind("suggestedActionClick",(function(t){const s={text:t.text};e.trigger(ut,{message:s}),e.postMessage(s)})).bind("messageToolbarExecute",(function(t){const s=e.dataItem(t.message);e.trigger(wt,{type:t.type,message:s})})).bind("fileMenuExecute",(function(t){e.commandExecute(t)})).bind("downloadAllFiles",(function(t){const s=e.dataItem(t.messageElement);e.trigger(kt,{files:s.files,message:s})})).bind("expandableToggle",(function(e){Ht(e.indicator,e.isExpanded)})),this.messageBox.bind("input",(function(t){e.trigger(bt,{value:t.value})})).bind("sendMessage",(function(t){const s=t.generating;if(s)e.trigger(ut,{generating:s});else{const s={text:t.text,files:t.files};e.trigger(ut,{message:s}),e.postMessage(s),e.clearReplyState()}})).bind("suggestionClick",(function(t){e.trigger(mt,{text:t.text})})).bind("fileButtonClick",(function(){e.messageBox.wrapper.find(`[${gt}]`).trigger("click")})).bind("replyMessageCloseButtonClick",(function(){e.clearReplyState()})),this.messageContextMenu.bind("execute",this.commandExecute.bind(this)).bind("open",this.messageContextMenuOpen.bind(this)),this.wrapper.on(o+j,`[${at}]`,(()=>{this.trigger(ft,{message:this._dataManager.getPinnedMessage()}),this.clearPinnedMessage()})),this.wrapper.on(o+j,`[${it}]`,(e=>{if($(e.target).closest(`[${at}]`).length)return;if($(e.target).is("a"))return;e.preventDefault(),e.stopPropagation();const t=this._dataManager.getPinnedMessage();t&&t.uid&&this.scrollToMessage(t.uid)})),this.wrapper.on(o+j,`[${ot}]`,(e=>{if($(e.target).is("a"))return;e.preventDefault(),e.stopPropagation();const t=$(e.currentTarget).closest(i+de);const s=this.dataItem(t);if(s&&s.replyToId){const e=this._dataManager.getMessageById(s.replyToId);e&&e.uid&&this.scrollToMessage(e.uid)}})),this.wrapper.on("keydown"+j,(e=>{((e,t,s)=>{if(!$(e.target).closest(t).length)return null;const n=$(e.target);const i=e.keyCode||e.which;Ut=!0,Rt=e.shiftKey,n.hasClass(K)&&Gt(e,i,t),n.hasClass(De)&&Vt(e,i),n.hasClass(Z)&&Wt(e,i),n.hasClass("k-input-inner")&&qt(e,i,t,s),n.closest(".k-input-suffix .k-button").length&&Vt(e,i)})(e,this.wrapper,this.messageBox)})),this.wrapper.on(`focus${j}`,`.${K}`,(e=>{const t=$(e.target);if(!(t.find(`.${Le}`).length>0)&&"true"===t.attr("data-keyboard-focus")){const e=t.closest(`.${de}`);const s=this.dataItem(e);s&&s.uid&&this.scrollToMessage(s.uid)}}))}_dataSource(){const e=this;const t=e.options;e._refreshHandler=e.refresh.bind(e),e._dataManager=new es(t),e.dataSource=e._dataManager.getDataSource(),e.dataSource.bind(l,e._refreshHandler)}_unbindDataSource(){this.dataSource.unbind(l,this._refreshHandler),this._dataManager=null}setDataSource(e){const t=this;t.dataSource&&t._unbindDataSource(),t.view.clearMessages(),t.options.dataSource=e,t._dataSource(),t.options.autoBind&&t.dataSource.fetch(),this.view&&this.view._refreshDataManager(t._dataManager)}_user(){const e=this.options;e.authorId?this.options.authorId=e.authorId.toString():this.options.authorId=v()}getUserId(){return this.options.authorId}_wrapper(){const e=this.options;const t=e.height;const s=e.width;const n=e.headerItems;const i="<div class='"+Fe+"'></div>";var o;this.wrapper=this.element.addClass(Ue).attr("dir",e.dir).append(i),this._hasHeader&&this.wrapper.prepend((o=n,new kendo.ui.AppBar(`<div class="${re}">`,{items:o,positionMode:"sticky"}).element[0].outerHTML)),t&&this.wrapper.css({height:t,minHeight:t}),s&&this.wrapper.css({width:s,minWidth:s})}_view(){const e=w(!0,{},this.options,{dataManager:this._dataManager});const t=this.wrapper.find(i+Fe+"");this.view=new Xt(t,e)}_messageBox(){const e=w(!0,{},this.options,{chatElement:this.wrapper});this.messageBox=new Yt($("<textarea></textarea>"),e)}_createMenus(){const e=this.options.messageActions;this.messageContextMenu=new ts($("<ul></ul>"),{dataSource:e})}commandExecute(e){const t=this.dataItem(e.message);const s=this.fileDataItem(t,e.file);const n=e.type;if(s){if(n===St)this.trigger(kt,{files:[s],message:t});this.trigger(Mt,{type:n,file:s,message:t})}else{switch(n){case _t:this.messageReply(t);break;case Ct:this.messageCopy(t);break;case Tt:this.messagePin(t);break;case $t:this.messageDelete(t)}this.trigger(vt,{type:n,message:t})}}messageReply(e){const t=e.authorId===this.getUserId();this.currentMessageReplyId=e.id,this.messageBox.setReplyMessage(e,t),Kt(this.wrapper,this.options)}messageCopy(e){navigator&&navigator.clipboard&&navigator.clipboard.writeText(e.text)}messagePin(e){this._dataManager.pinMessage(e)}messageDelete(e){this.removeMessage(e)}messageContextMenuOpen(e){const t=this.dataItem(e.message);if(!t)return;const s=t.authorId===this.getUserId();this.messageContextMenu.toggleDeleteVisibility(s)}dataItem(e){return this.view.dataItem(e)}fileDataItem(e,t){return this.view.fileDataItem(e,t)}clearMessages(){this.view.clearMessages()}postMessage(e){this.currentMessageReplyId&&(e.replyToId=this.currentMessageReplyId);return this._dataManager.postMessage(e,this.getUserId())}removeMessage(e){return this._dataManager.removeMessage(e)}updateMessage(e,t){return this._dataManager.updateMessage(e,t)}getMessageByUid(e){return this._dataManager.getMessageByUid(e)}renderMessage(e){this.view.renderMessage(e),jt(this.wrapper)}renderPinnedMessage(e){const t=e.authorId===this.getUserId();const s=$(this.options.messageReferenceTemplate({text:e.text,files:e.files,isDeleted:e.isDeleted,isOwnMessage:t,messages:this.options.messages,isPinMessage:!0,renderCloseButton:!0,renderFileMenuButton:!1}));this.wrapper.find(`[${it}]`).remove(),this._hasHeader?s.insertAfter(this.wrapper.find(i+re)):this.wrapper.prepend(s),this.view._initFileMenus(s)}clearPinnedMessage(){this._dataManager.clearPinnedMessage(),this.wrapper.find(i+ve).remove()}clearReplyState(){this.messageBox.removeReplyMessage(),this.currentMessageReplyId=null}scrollToBottom(){this.view.scrollToBottom()}scrollToMessage(e){return this.view.scrollToMessage(e)}toggleSendButtonGenerating(e){this.messageBox.toggleSendButtonGenerating(e)}refresh(e){const t=this;const s=t.dataSource.view();const n=s.find((e=>e.isPinned));const i=e.changedItems||[];if(e&&e.action||(s.forEach((e=>{t.renderMessage(e)})),t.scrollToBottom()),n&&t.renderPinnedMessage(n),"sync"===e.action){const e=i.length?i[0]:s[s.length-1];t.renderMessage(e),i.length||t.scrollToBottom()}t.view.renderSuggestedActions(),zt(t.wrapper,t.options),jt(t.wrapper)}}kendo.chat={},w(kendo.chat,{ChatView:{},Component:{},Components:{},Templates:{},getTemplate:()=>k("The getTemplate method is deprecated. Use one of the built-in templates or append elements manually.","warn"),getComponent:()=>k("The getComponent method is deprecated. Use one of the built-in templates or append elements manually.","warn"),registerTemplate:()=>k("The registerTemplate method is deprecated. Use one of the built-in templates or append elements manually.","warn"),registerComponent:()=>k("The registerComponent method is deprecated. Use one of the built-in templates or append elements manually.","warn")}),function(e,t=kendo.ui,s=""){const n=e.options?.name||e.fn.options.name;let i;t[n]=e,t.roles[n.toLowerCase()]=e,e.prototype.options={...e.prototype.options,...e.options},e.fn.options={...e.fn.options,...e.options},i="getKendo"+s+n;const o="kendo"+s+n;const a={name:o,widget:e,prefix:s||""};kendo.widgets.push(a);const r=window.jQuery||jQuery||kendo?.jQuery;r.fn[o]=function(t){let s=this;let n;return"string"==typeof t?(n=z.call(arguments,1),this.each((function(){const e=r.data(this,o);let i;let a;if(!e)throw new Error(kendo.format("Cannot call method '{0}' of {1} before it is initialized",t,o));if(i=e[t],!b(i))throw new Error(kendo.format("Cannot find method '{0}' of {1}",t,o));if(a=i.apply(e,n),void 0!==a)return s=a,!1}))):this.each((function(){return new e(this,t)})),s},r.fn[o].widget=e,r.fn[i]=function(){return this.data(o)}}(ss);var ns=kendo;e.Chat=ss,e.__meta__={id:"chat",name:"Chat",category:"web",description:"The Chat component.",depends:["data","draganddrop","html.button","textarea","menu","avatar","toolbar","speechtotextbutton"]},e.default=ns,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=kendo.chat.min.js.map
